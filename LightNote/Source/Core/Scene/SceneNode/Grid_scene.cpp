//=============================================================================
//Åy Grid Åz
//=============================================================================

//-------------------------------------------------------------------------
//
//-------------------------------------------------------------------------
#include "stdafx.h"
#include "../../Graphics/Manager.h"
#include "../SceneGraph.h"
#include "Grid.h"

//-------------------------------------------------------------------------
//
//-------------------------------------------------------------------------
namespace LNote
{
namespace Core
{
namespace Scene
{

//==============================================================================
// Grid::DrawingContext
//==============================================================================
class Grid::DrawingContext
	: public VisualNodeContext
{
public:
	DrawingContext(){}
	virtual ~DrawingContext() {}

protected:

	//----------------------------------------------------------------------
	//
	//----------------------------------------------------------------------
	virtual void updateContext(SceneNodeContext* parentContext)
	{
		VisualNodeContext::updateContext(parentContext);

		Grid* ownerNode = static_cast<Grid*>(mSceneNode);
	}

	//----------------------------------------------------------------------
	//
	//----------------------------------------------------------------------
	virtual void drawSubset(ContextDrawParam& param, int index)
	{
	}

private:
	Graphics::Grid* mGrid;
};

//=============================================================================
// Grid
//=============================================================================

	//---------------------------------------------------------------------
	//
	//---------------------------------------------------------------------
    Grid::Grid( SceneGraph* scene )
        : SceneNode     ( scene )
        , mGrid         ( NULL )
    {
    }

	//---------------------------------------------------------------------
	//
	//---------------------------------------------------------------------
    Grid::~Grid()
    {
        LN_SAFE_RELEASE( mGrid );
    }

	//---------------------------------------------------------------------
	//
	//---------------------------------------------------------------------
    void Grid::initialize()
    {
        SceneNode::initialize( 1, LN_DRAWCOORD_3D );

        mGrid = LN_NEW Graphics::Grid();
        mGrid->initialize(this->mSceneGraph->getGraphicsManager()->getGraphicsDevice());

        // ÉâÉCÉeÉBÉìÉOÇ»Çµ
        setShader( this->mSceneGraph->getDefaultShader( LN_DEFSHADER_NOLIGHTING ) );
    }

	//---------------------------------------------------------------------
	//
	//---------------------------------------------------------------------
    LNRESULT Grid::drawSubset( lnU32 index )
    {
        return mGrid->draw();
    }

//-------------------------------------------------------------------------
//
//-------------------------------------------------------------------------

} // namespace Scene
} // namespace Core
} // namespace LNote

//=============================================================================
//                              end of file
//=============================================================================